query Booking($id: ItemId!) {
	booking(filter: { id: { eq: $id } }) {
		...BookingFragment
	}
}

query AllBookings($first: IntType = 500, $skip: IntType = 0) {
	allBookings(first: $first, skip: $skip) {
		...BookingLightFragment
	}
	_allBookingsMeta {
		count
	}
}

query AllBookingsByMember($first: IntType = 500, $skip: IntType = 0, $memberId: ItemId) {
	allBookings(first: $first, skip: $skip, filter: { member: { eq: $memberId } }) {
		...BookingLightFragment
	}
	_allBookingsMeta(filter: { member: { eq: $memberId } }) {
		count
	}
}
query PastBookingsByMember(
	$first: IntType = 500
	$skip: IntType = 0
	$memberId: ItemId
	$now: DateTime
) {
	allBookings(
		first: $first
		skip: $skip
		filter: { member: { eq: $memberId }, start: { lte: $now } }
	) {
		...BookingLightFragment
	}
	_allBookingsMeta(filter: { member: { eq: $memberId }, start: { lte: $now } }) {
		count
	}
}
query FutureBookingsByMember(
	$first: IntType = 500
	$skip: IntType = 0
	$memberId: ItemId
	$now: DateTime
) {
	allBookings(
		first: $first
		skip: $skip
		filter: { member: { eq: $memberId }, start: { gte: $now }, aborted: { exists: false } }
	) {
		...BookingLightFragment
	}
	_allBookingsMeta(
		filter: { member: { eq: $memberId }, start: { gte: $now }, aborted: { exists: false } }
	) {
		count
	}
}

query AllBookingsSearch(
	$first: IntType = 500
	$skip: IntType = 0
	$start: DateTime
	$end: DateTime
	$workshopId: ItemId
	$equipmentIds: [ItemId]
) {
	_allBookingsMeta(
		filter: {
			AND: [{ start: { lte: $end } }, { end: { gte: $start } }]
			aborted: { exists: false }
			workshop: { eq: $workshopId }
			equipment: { anyIn: $equipmentIds }
		}
	) {
		count
	}
	allBookings(
		first: $first
		skip: $skip
		filter: {
			AND: [{ start: { lte: $end } }, { end: { gte: $start } }]
			aborted: { exists: false }
			workshop: { eq: $workshopId }
			equipment: { anyIn: $equipmentIds }
		}
	) {
		id
		start
		end
		note
		workshop {
			id
			title
		}
		equipment {
			id
			title
			titleShort
			bookable
			exclusive
		}
		member {
			id
			firstName
			lastName
			user
		}
	}
}

fragment BookingFragment on BookingRecord {
	id
	start
	end
	aborted
	note
	member {
		... on MemberRecord {
			...MemberFragment
		}
	}
	workshop {
		... on WorkshopRecord {
			...WorkshopFragment
		}
	}
	equipment {
		...EquipmentLightFragment
	}
	report {
		...ReportLightFragment
	}
}

fragment BookingLightFragment on BookingRecord {
	id
	start
	end
	aborted
	member {
		... on MemberRecord {
			...MemberLightFragment
		}
	}
	workshop {
		... on WorkshopRecord {
			email
			image {
				...ImageFragment
			}
			priceDay
			priceHour
			priceMonth
			priceWeek
			title
			titleLong
		}
	}
	equipment {
		...EquipmentLightFragment
	}
	report {
		id
	}
	note
}
